#!/usr/bin/env ruby

require 'fileutils'

dir = File.dirname(__FILE__)

new_application_dir = "#{dir}/../lib/new_application"

@command = ARGV[0]

if @command == "init"

  # Create the structure for a YMDP project

  @project_name = ARGV[1]

  @message = <<MESSAGE
Creating YMDP directory for project #{@project_name}

First, run:

  gem bundle

Then:

  ./script/config

Then open config.yml and set your username and password.
Then open servers.yml and set your server keys.

Then run:

  bin/rake create:all

to fetch your applications from Yahoo! Mail's servers.

MESSAGE

  puts @message

  FileUtils.mkdir_p(@project_name)
  FileUtils.cp_r("#{new_application_dir}/.", @project_name)
elsif @command == "update"
  puts "Updating scripts..."
  FileUtils.cp_r(Dir.glob("#{new_application_dir}/config/*.example"), "./config", :verbose => true)
  FileUtils.cp_r("#{new_application_dir}/lib/tasks/.", "./lib/tasks", :verbose => true)
  FileUtils.cp_r("#{new_application_dir}/script/.", "./script", :verbose => true)
  FileUtils.cp_r("#{new_application_dir}/ymdp", "./", :verbose => true)
end

